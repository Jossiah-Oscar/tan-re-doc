databaseChangeLog:
  #####################################################################
  # 1. Create core tables (no generated columns)
  #####################################################################
  - changeSet:
      id: 20250802-001
      author: jkibona
      changes:

        # 1.1 business_class
        - createTable:
            tableName: business_class
            columns:
              - column:
                  name: id
                  type: SERIAL
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
                    unique: true

        # 1.2 contract_type
        - createTable:
            tableName: contract_type
            columns:
              - column:
                  name: id
                  type: SERIAL
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
                    unique: true

        # 1.3 currency
        - createTable:
            tableName: currency
            columns:
              - column:
                  name: code
                  type: VARCHAR(10)
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: exchange_rate
                  type: NUMERIC(18,8)
                  constraints:
                    nullable: false

        # 1.4 surplus_retro_program
        - createTable:
            tableName: surplus_retro_program
            columns:
              - column:
                  name: id
                  type: SERIAL
                  constraints:
                    primaryKey: true
              - column:
                  name: business_class_id
                  type: INTEGER
                  constraints:
                    nullable: false
                    foreignKeyName: fk_program_business_class
                    references: business_class(id)
              - column:
                  name: contract_type_id
                  type: INTEGER
                  constraints:
                    nullable: false
                    foreignKeyName: fk_program_contract_type
                    references: contract_type(id)
              - column:
                  name: retention
                  type: BIGINT
              - column:
                  name: lines
                  type: INTEGER
              - column:
                  name: treaty_limit
                  type: BIGINT
              - column:
                  name: total_capacity
                  type: BIGINT
              - column:
                  name: rms_code
                  type: VARCHAR(20)
              - column:
                  name: currency_code
                  type: VARCHAR(10)
                  defaultValue: TZS
                  constraints:
                    nullable: false
                    foreignKeyName: fk_program_currency
                    references: currency(code)
              - column:
                  name: year
                  type: INTEGER

        - addUniqueConstraint:
            tableName: surplus_retro_program
            columnNames: business_class_id, contract_type_id, rms_code, year
            constraintName: uq_program_unique_entry

        # 1.5 policy_cessions_program
        - createTable:
            tableName: policy_cessions_program
            columns:
              - column:
                  name: id
                  type: SERIAL
                  constraints:
                    primaryKey: true
              - column:
                  name: business_class_id
                  type: INTEGER
                  constraints:
                    nullable: false
                    foreignKeyName: fk_policy_program_business_class
                    references: business_class(id)
              - column:
                  name: contract_type_id
                  type: INTEGER
                  constraints:
                    nullable: false
                    foreignKeyName: fk_policy_program_contract_type
                    references: contract_type(id)
              - column:
                  name: retention
                  type: BIGINT
              - column:
                  name: lines
                  type: INTEGER
              - column:
                  name: treaty_limit
                  type: BIGINT
              - column:
                  name: total_capacity
                  type: BIGINT
              - column:
                  name: rms_code
                  type: VARCHAR(20)
              - column:
                  name: currency_code
                  type: VARCHAR(10)
                  defaultValue: TZS
                  constraints:
                    nullable: false
                    foreignKeyName: fk_policy_program_currency
                    references: currency(code)
              - column:
                  name: year
                  type: INTEGER

        - addUniqueConstraint:
            tableName: policy_cessions_program
            columnNames: business_class_id, contract_type_id, rms_code, year
            constraintName: uq_policy_program_unique_entry

        # 1.6 auto_fac_retro_program
        - createTable:
            tableName: auto_fac_retro_program
            columns:
              - column:
                  name: id
                  type: SERIAL
                  constraints:
                    primaryKey: true
              - column:
                  name: business_class_id
                  type: INTEGER
                  constraints:
                    nullable: false
                    foreignKeyName: fk_auto_fac_business_class
                    references: business_class(id)
              - column:
                  name: tzs_capacity
                  type: BIGINT
              - column:
                  name: usd_capacity
                  type: BIGINT
              - column:
                  name: year
                  type: INTEGER

        - addUniqueConstraint:
            tableName: auto_fac_retro_program
            columnNames: business_class_id, year
            constraintName: uq_auto_fac_program_unique_entry